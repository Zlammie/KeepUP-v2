<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Lender Details</title>

  <link rel="stylesheet" href="/assets/css/main.css">
  <!-- Pills & topbar styles reused from contacts -->
  

  <style>
    :root{
      --brand:#2f70c8; --ink:#0f172a; --muted:#64748b; --border:#e5e7eb; --radius:14px;
    }
    .lender-shell{display:flex;flex-direction:column;gap:1rem;}

    /* Collapsed identity */
    .id-card{
      position:relative;background:#fff;border:1px solid var(--border);
      border-left:3px solid var(--brand);border-radius:var(--radius);
      padding:.75rem 1.25rem;display:flex;align-items:center;gap:1rem;flex-wrap:wrap;
      box-shadow:0 1px 2px rgba(0,0,0,.03);
    }
    .id-left{display:flex;flex-direction:column;}
    .id-name{font-size:1.125rem;line-height:1.25rem;font-weight:700;color:var(--ink);}
    .id-contact{display:flex;align-items:center;gap:1rem;margin-top:.35rem;color:var(--muted);}
    .id-contact a{color:inherit;text-decoration:none;} .id-contact a:hover{text-decoration:underline;}
    .id-cta{margin-left:auto;}
    .btn-ghost{border:1px solid var(--brand);background:transparent;color:var(--brand);
      border-radius:999px;padding:.3rem .8rem;cursor:pointer;}
    .btn-ghost:hover{background:rgba(47,112,200,.06);}

    /* Expanded editor */
    .edit-card{
      background:#fff;border:1px solid var(--border);border-radius:var(--radius);
      padding:1rem 1.25rem 1.25rem;box-shadow:0 1px 3px rgba(0,0,0,.04);
    }
    .edit-title{font-weight:700;color:var(--ink);padding-bottom:.5rem;margin-bottom:.75rem;border-bottom:1px dashed var(--border);}
    .grid{display:grid;grid-template-columns: repeat(2, minmax(0,1fr));gap:1rem 1.25rem;}
    .grid .full{grid-column:1 / -1;}
    .form label{display:block;font-size:.85rem;color:var(--muted);margin-bottom:.25rem;}
    .form input{width:100%;padding:.45rem .6rem;border-radius:10px;border:1px solid var(--border);outline:none;background:#fff;color:#111;box-sizing:border-box;}
    .form input:focus{border-color:var(--brand);box-shadow:0 0 0 3px rgba(47,112,200,.12);}
    .form input:disabled{opacity:.7;background:#fafafa;}

    /* helpers */
    .is-hidden{display:none!important;}
    .d-none{display:none!important;} /* fallback if Bootstrap not present */
    .topbar-spacer{height:.25rem;}
    .status-badge{display:inline-block;padding:2px 8px;border:1px solid #e5e7eb;border-radius:999px;font-size:.85rem;line-height:1.2;background:#fff;}
    .tab-switcher{
      display:flex;gap:.35rem;margin-top:.75rem;flex-wrap:wrap;
      border-bottom:1px solid var(--border);padding-bottom:.2rem;
    }
    .tab-btn{
      border:1px solid var(--border);border-bottom:none;background:#f8fafc;color:var(--muted);
      border-radius:12px 12px 0 0;
      padding:.4rem 1.1rem;font-size:.9rem;font-weight:600;
      cursor:pointer;transition:all .18s ease;position:relative;top:1px;
    }
    .tab-btn:hover{color:var(--ink);}
    .tab-btn.active{
      background:#fff;color:var(--brand);border-color:var(--brand);border-bottom:1px solid #fff;
      box-shadow:0 -1px 6px rgba(47,112,200,.15);
    }
    .tab-panel{margin-top:0;padding-top:.75rem;}

  </style>
</head>
<body>
  <%- include('../partials/nav') %>
  <%- include('../partials/top-nav-contacts') %>

  <div class="container main-content">
    <div class="lender-shell">

      <!-- Collapsed identity card -->
      <section class="id-card">
        <div class="id-left">
          <div class="id-name" id="hdrName">LENDER NAME</div>
          <div class="id-contact">
            <a id="hdrPhone" href="#">Phone Number</a>
            <a id="hdrEmail" href="#">Email</a>
          </div>
        </div>
        <div class="id-cta">
          <button id="toggleEdit" class="btn-ghost">Edit</button>
        </div>
      </section>

      <!-- Expanded editor (hidden by default) -->
      <section id="editorCard" class="edit-card is-hidden">
        <div class="edit-title" id="titleName">LENDER NAME</div>

        <form id="lenderForm" class="form">
          <input type="hidden" id="lenderId" />
          <div class="grid">
            <div>
              <label>First Name</label>
              <input type="text" id="lenderFirstName" data-field="firstName" />
            </div>
            <div>
              <label>Last Name</label>
              <input type="text" id="lenderLastName" data-field="lastName" />
            </div>
            <div>
              <label>Phone</label>
              <input type="text" id="lenderPhone" data-field="phone" />
            </div>
            <div>
              <label>Email</label>
              <input type="email" id="lenderEmail" data-field="email" />
            </div>
            <div class="full">
              <label>Company</label>
              <input type="text" id="lenderCompany" data-field="company" />
            </div>
          </div>
        </form>
      </section>

      <!-- Top bar (same structure/IDs as contacts) -->
      <div class="topbar-spacer"></div>
      <div id="lenderTopBar" class="contact-topbar">
        <div class="topbar-left">
          <label for="communitySelect" class="visually-hidden">Community</label>
          <select id="communitySelect" class="form-select form-select-sm"></select>
          <div class="topbar-total">
            <span class="total-label">Total:</span>
            <span id="countTotal" class="total-value">0</span>
          </div>
        </div>

        <div class="topbar-filters" id="statusFilters"></div>

        <button id="toggleFilterMode" class="btn btn-sm btn-outline-secondary">More</button>
        <button id="resetFilters" class="btn btn-sm btn-outline-secondary">Reset</button>
      </div>

      <div class="tab-switcher" role="tablist">
        <button id="tabAllContacts" class="tab-btn active" type="button" role="tab" aria-selected="true">All Contacts</button>
        <button id="tabPurchasedContacts" class="tab-btn" type="button" role="tab" aria-selected="false">Purchasers</button>
      </div>

      <div id="tabPanelAll" class="tab-panel" role="tabpanel">
        <div class="card">
          <table class="table linked-table">
            <thead>
              <tr>
                <th><span class="visually-hidden">Task</span></th>
                <th><span class="visually-hidden">Flag</span></th>
                <th><span class="visually-hidden">Comment</span></th>
                <th>Name</th><th>Phone</th><th>Email</th>
                <th>Community</th><th>Owner</th><th>Contact Status</th>
                <th>Lender Status</th><th>Invite Date</th><th>Approved Date</th>
              </tr>
            </thead>
            <tbody id="relatedContactsBody" class="relatedContactBody"></tbody>
          </table>
        </div>
      </div>

      <div id="tabPanelPurchased" class="tab-panel is-hidden" role="tabpanel" aria-hidden="true">
        <div class="card">
          <table class="table linked-table">
            <thead>
              <tr>
                <th><span class="visually-hidden">Task</span></th>
                <th><span class="visually-hidden">Flag</span></th>
                <th><span class="visually-hidden">Comment</span></th>
                <th>Name</th><th>Phone</th><th>Email</th>
                <th>Community</th><th>Lender Status</th>
                <th>Closing Status</th><th>Closing Date</th>
              </tr>
            </thead>
            <tbody id="purchasedContactsBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="/assets/js/lender-view/index.js"></script>
</body>
</html>
